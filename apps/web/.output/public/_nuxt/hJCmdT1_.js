var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import __nuxt_component_2 from"./BPHwrUJ4.js";import{z as defineComponent,f as ref,E as computed,y as watch,O as createElementBlock,X as createVNode,W as withCtx,G as unref,T as Transition,P as openBlock,a5 as createCommentVNode,a2 as createBaseVNode,a3 as toDisplayString,L as Fragment,a8 as renderList}from"./BRSJK7Xo.js";import{b as useRouter}from"./BGn8T2aB.js";import{_ as _sfc_main$1}from"./DGo9Esvu.js";import{u as useSearch}from"./DNStO8Ax.js";import"./B8R4opHw.js";import"./CDtqPBeL.js";const _hoisted_1={class:"relative w-full max-w-2xl"},_hoisted_2={key:0,class:"flex items-center"},_hoisted_3={key:0,class:"absolute z-50 mt-1 w-full rounded-lg bg-white shadow-lg ring-1 ring-black ring-opacity-5"},_hoisted_4={key:0,class:"px-4 py-8 text-center"},_hoisted_5={key:1,class:"px-4 py-8 text-center"},_hoisted_6={class:"text-sm text-neutral-500"},_hoisted_7={key:2,class:"max-h-96 overflow-y-auto"},_hoisted_8={class:"p-2"},_hoisted_9={key:0,class:"mb-2"},_hoisted_10=["onClick"],_hoisted_11={class:"flex-1 min-w-0"},_hoisted_12={class:"text-sm font-medium text-neutral-900 truncate"},_hoisted_13={class:"text-xs text-neutral-500"},_hoisted_14={key:0},_hoisted_15={key:1},_hoisted_16={key:2},_hoisted_17={class:"text-xs text-neutral-400"},_hoisted_18={key:1,class:"mb-2"},_hoisted_19=["onClick"],_hoisted_20={class:"flex-1 min-w-0"},_hoisted_21={class:"text-sm font-medium text-neutral-900 truncate"},_hoisted_22={class:"text-xs text-neutral-500"},_hoisted_23={key:0},_hoisted_24={key:1},_hoisted_25={key:2},_hoisted_26={class:"text-xs text-neutral-400"},_hoisted_27={key:3,class:"border-t border-neutral-200 px-4 py-2"},_sfc_main=defineComponent({__name:"GlobalSearch",setup(__props){const router=useRouter(),searchQuery=ref(""),isOpen=ref(!1),{results,isSearching,hasResults,search}=useSearch({limit:10,debounce:300}),fileResults=computed(()=>results.value.filter(r=>r.metadata.type==="file").slice(0,5)),supplierResults=computed(()=>results.value.filter(r=>r.metadata.type==="supplier").slice(0,5));watch(searchQuery,value=>{value.trim()&&search(value)});const handleBlur=__name(()=>{setTimeout(()=>{isOpen.value=!1},200)},"handleBlur"),handleFileClick=__name(file=>{const fileId=file.id.split(":").pop();router.push(`/files/${fileId}`),isOpen.value=!1,searchQuery.value=""},"handleFileClick"),handleSupplierClick=__name(supplier=>{const supplierId=supplier.id.split(":").pop();router.push(`/suppliers/${supplierId}`),isOpen.value=!1,searchQuery.value=""},"handleSupplierClick"),viewAllResults=__name(()=>{router.push({path:"/search",query:{q:searchQuery.value}}),isOpen.value=!1},"viewAllResults");return(_ctx,_cache)=>{const _component_Icon=__nuxt_component_2;return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(unref(_sfc_main$1),{modelValue:searchQuery.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>searchQuery.value=$event),size:"lg",placeholder:"Search files, suppliers, documents...",clearable:"",class:"w-full",onFocus:_cache[1]||(_cache[1]=$event=>isOpen.value=!0),onBlur:handleBlur},{leading:withCtx(()=>[createVNode(_component_Icon,{name:"heroicons:magnifying-glass",class:"h-5 w-5 text-neutral-400"})]),trailing:withCtx(()=>[unref(isSearching)?(openBlock(),createElementBlock("div",_hoisted_2,[createVNode(_component_Icon,{name:"heroicons:arrow-path",class:"h-4 w-4 animate-spin text-neutral-400"})])):createCommentVNode("",!0)]),_:1},8,["modelValue"]),createVNode(Transition,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"transform scale-95 opacity-0","enter-to-class":"transform scale-100 opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"transform scale-100 opacity-100","leave-to-class":"transform scale-95 opacity-0"},{default:withCtx(()=>[isOpen.value&&(unref(hasResults)||unref(isSearching)||searchQuery.value)?(openBlock(),createElementBlock("div",_hoisted_3,[unref(isSearching)&&!unref(hasResults)?(openBlock(),createElementBlock("div",_hoisted_4,[createVNode(_component_Icon,{name:"heroicons:arrow-path",class:"h-6 w-6 animate-spin text-neutral-400 mx-auto mb-2"}),_cache[2]||(_cache[2]=createBaseVNode("p",{class:"text-sm text-neutral-500"},"Searching...",-1))])):!unref(hasResults)&&searchQuery.value&&!unref(isSearching)?(openBlock(),createElementBlock("div",_hoisted_5,[createVNode(_component_Icon,{name:"heroicons:magnifying-glass",class:"h-6 w-6 text-neutral-400 mx-auto mb-2"}),createBaseVNode("p",_hoisted_6,'No results found for "'+toDisplayString(searchQuery.value)+'"',1)])):unref(hasResults)?(openBlock(),createElementBlock("div",_hoisted_7,[createBaseVNode("div",_hoisted_8,[fileResults.value.length>0?(openBlock(),createElementBlock("div",_hoisted_9,[_cache[3]||(_cache[3]=createBaseVNode("h3",{class:"px-3 py-1 text-xs font-semibold text-neutral-500 uppercase tracking-wider"},"Files",-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(fileResults.value,file=>(openBlock(),createElementBlock("button",{key:file.id,onClick:__name($event=>handleFileClick(file),"onClick"),class:"w-full text-left px-3 py-2 hover:bg-neutral-50 rounded-md transition-colors flex items-center gap-3"},[createVNode(_component_Icon,{name:"heroicons:document",class:"h-5 w-5 text-neutral-400 flex-shrink-0"}),createBaseVNode("div",_hoisted_11,[createBaseVNode("p",_hoisted_12,toDisplayString(file.metadata.fileName),1),createBaseVNode("p",_hoisted_13,[file.metadata.category?(openBlock(),createElementBlock("span",_hoisted_14,toDisplayString(file.metadata.category),1)):createCommentVNode("",!0),file.metadata.category&&file.metadata.supplierName?(openBlock(),createElementBlock("span",_hoisted_15," · ")):createCommentVNode("",!0),file.metadata.supplierName?(openBlock(),createElementBlock("span",_hoisted_16,toDisplayString(file.metadata.supplierName),1)):createCommentVNode("",!0)])]),createBaseVNode("span",_hoisted_17,toDisplayString(Math.round(file.score*100))+"%",1)],8,_hoisted_10))),128))])):createCommentVNode("",!0),supplierResults.value.length>0?(openBlock(),createElementBlock("div",_hoisted_18,[_cache[4]||(_cache[4]=createBaseVNode("h3",{class:"px-3 py-1 text-xs font-semibold text-neutral-500 uppercase tracking-wider"},"Suppliers",-1)),(openBlock(!0),createElementBlock(Fragment,null,renderList(supplierResults.value,supplier=>(openBlock(),createElementBlock("button",{key:supplier.id,onClick:__name($event=>handleSupplierClick(supplier),"onClick"),class:"w-full text-left px-3 py-2 hover:bg-neutral-50 rounded-md transition-colors flex items-center gap-3"},[createVNode(_component_Icon,{name:"heroicons:building-office",class:"h-5 w-5 text-neutral-400 flex-shrink-0"}),createBaseVNode("div",_hoisted_20,[createBaseVNode("p",_hoisted_21,toDisplayString(supplier.metadata.displayName),1),createBaseVNode("p",_hoisted_22,[supplier.metadata.companyNumber?(openBlock(),createElementBlock("span",_hoisted_23,toDisplayString(supplier.metadata.companyNumber),1)):createCommentVNode("",!0),supplier.metadata.companyNumber&&supplier.metadata.vatNumber?(openBlock(),createElementBlock("span",_hoisted_24," · ")):createCommentVNode("",!0),supplier.metadata.vatNumber?(openBlock(),createElementBlock("span",_hoisted_25,toDisplayString(supplier.metadata.vatNumber),1)):createCommentVNode("",!0)])]),createBaseVNode("span",_hoisted_26,toDisplayString(Math.round(supplier.score*100))+"%",1)],8,_hoisted_19))),128))])):createCommentVNode("",!0)])])):createCommentVNode("",!0),unref(hasResults)?(openBlock(),createElementBlock("div",_hoisted_27,[createBaseVNode("button",{onClick:viewAllResults,class:"text-sm text-primary-600 hover:text-primary-700 font-medium"}," View all results → ")])):createCommentVNode("",!0)])):createCommentVNode("",!0)]),_:1})])}}}),__nuxt_component_1=Object.assign(_sfc_main,{__name:"GlobalSearch"});export{__nuxt_component_1 as default};
