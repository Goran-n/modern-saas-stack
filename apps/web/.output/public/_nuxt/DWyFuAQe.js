var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import __nuxt_component_2 from"./BPHwrUJ4.js";import{d as useRoute,b as useRouter}from"./BGn8T2aB.js";import{_ as _sfc_main$3}from"./rIxWFMco.js";import{_ as _sfc_main$4}from"./BeaoTUGu.js";import{_ as _sfc_main$1}from"./DGo9Esvu.js";import{_ as _sfc_main$2}from"./Dlem1RG-.js";import{u as useSearch}from"./DNStO8Ax.js";import{z as defineComponent,f as ref,E as computed,y as watch,O as createElementBlock,X as createVNode,W as withCtx,G as unref,P as openBlock,a2 as createBaseVNode,a3 as toDisplayString,a5 as createCommentVNode,L as Fragment,a8 as renderList,V as createBlock,a4 as createTextVNode}from"./BRSJK7Xo.js";import"./B8R4opHw.js";import"./LqpTdS2-.js";import"./CKrwGQ3G.js";import"./CDtqPBeL.js";function formatDate(date){const d=typeof date=="string"?new Date(date):date,diffMs=new Date().getTime()-d.getTime(),diffDays=Math.floor(diffMs/(1e3*60*60*24));if(diffDays===0){const diffHours=Math.floor(diffMs/36e5);return diffHours===0?`${Math.floor(diffMs/6e4)} minutes ago`:`${diffHours} hours ago`}else return diffDays===1?"Yesterday":diffDays<7?`${diffDays} days ago`:d.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}__name(formatDate,"formatDate");const _hoisted_1={class:"min-h-screen bg-neutral-50"},_hoisted_2={class:"mb-8"},_hoisted_3={class:"mt-2 text-gray-600"},_hoisted_4={key:0},_hoisted_5={key:1},_hoisted_6={class:"mb-6"},_hoisted_7={class:"mb-6 flex gap-3"},_hoisted_8={key:0,class:"flex justify-center py-12"},_hoisted_9={class:"text-center"},_hoisted_10={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"},_hoisted_11={class:"text-red-800"},_hoisted_12={key:2,class:"text-center py-12"},_hoisted_13={key:3,class:"space-y-6"},_hoisted_14={key:0},_hoisted_15={class:"text-lg font-semibold text-neutral-900 mb-4"},_hoisted_16={class:"grid gap-3"},_hoisted_17={class:"flex items-start gap-4"},_hoisted_18={class:"flex-1 min-w-0"},_hoisted_19={class:"font-medium text-neutral-900 truncate"},_hoisted_20={class:"mt-1 flex items-center gap-2 text-sm text-neutral-500"},_hoisted_21={key:0,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-neutral-100 text-neutral-700"},_hoisted_22={key:1},_hoisted_23={key:2,class:"text-xs"},_hoisted_24={key:0,class:"mt-2 text-sm text-neutral-600 line-clamp-2"},_hoisted_25={class:"text-sm text-neutral-400"},_hoisted_26={key:1},_hoisted_27={class:"text-lg font-semibold text-neutral-900 mb-4"},_hoisted_28={class:"grid gap-3"},_hoisted_29={class:"flex items-start gap-4"},_hoisted_30={class:"flex-1 min-w-0"},_hoisted_31={class:"font-medium text-neutral-900"},_hoisted_32={class:"text-sm text-neutral-500"},_hoisted_33={class:"mt-2 flex items-center gap-4 text-sm text-neutral-500"},_hoisted_34={key:0},_hoisted_35={key:1},_hoisted_36={class:"text-sm text-neutral-400"},_sfc_main=defineComponent({__name:"index",setup(__props){const route=useRoute(),router=useRouter(),searchQuery=ref(route.query.q||""),{results,isSearching,hasResults,error,search,filters}=useSearch({limit:50,debounce:300}),typeOptions=[{label:"Files",value:"file"},{label:"Suppliers",value:"supplier"},{label:"Documents",value:"document"}],categoryOptions=[{label:"Invoice",value:"invoice"},{label:"Receipt",value:"receipt"},{label:"Contract",value:"contract"},{label:"Purchase Order",value:"purchase_order"},{label:"Other",value:"other"}],fileResults=computed(()=>results.value.filter(r=>r.metadata.type==="file")),supplierResults=computed(()=>results.value.filter(r=>r.metadata.type==="supplier"));watch(searchQuery,value=>{search(value),router.push({query:{...route.query,q:value}})}),searchQuery.value&&search(searchQuery.value);const navigateToFile=__name(file=>{const fileId=file.id.split(":").pop();router.push(`/files/${fileId}`)},"navigateToFile"),navigateToSupplier=__name(supplier=>{const supplierId=supplier.id.split(":").pop();router.push(`/suppliers/${supplierId}`)},"navigateToSupplier");return(_ctx,_cache)=>{const _component_Icon=__nuxt_component_2;return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(unref(_sfc_main$4),{"max-width":"6xl",class:"py-8"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2,[_cache[3]||(_cache[3]=createBaseVNode("h1",{class:"text-3xl font-bold text-gray-900"},"Search Results",-1)),createBaseVNode("p",_hoisted_3,[searchQuery.value?(openBlock(),createElementBlock("span",_hoisted_4,'Results for "'+toDisplayString(searchQuery.value)+'"',1)):(openBlock(),createElementBlock("span",_hoisted_5,"Enter a search query to find files and suppliers"))])]),createBaseVNode("div",null,[createBaseVNode("div",_hoisted_6,[createVNode(unref(_sfc_main$1),{modelValue:searchQuery.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>searchQuery.value=$event),size:"xl",placeholder:"Search files, suppliers, documents...",clearable:"",class:"w-full max-w-2xl"},{leading:withCtx(()=>[createVNode(_component_Icon,{name:"heroicons:magnifying-glass",class:"h-5 w-5 text-neutral-400"})]),_:1},8,["modelValue"])]),createBaseVNode("div",_hoisted_7,[createVNode(unref(_sfc_main$2),{modelValue:unref(filters).type,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>unref(filters).type=$event),placeholder:"All types",options:typeOptions,clearable:"",size:"sm"},null,8,["modelValue"]),createVNode(unref(_sfc_main$2),{modelValue:unref(filters).category,"onUpdate:modelValue":_cache[2]||(_cache[2]=$event=>unref(filters).category=$event),placeholder:"All categories",options:categoryOptions,clearable:"",size:"sm"},null,8,["modelValue"])]),unref(isSearching)?(openBlock(),createElementBlock("div",_hoisted_8,[createBaseVNode("div",_hoisted_9,[createVNode(_component_Icon,{name:"heroicons:arrow-path",class:"h-8 w-8 animate-spin text-neutral-400 mx-auto mb-3"}),_cache[4]||(_cache[4]=createBaseVNode("p",{class:"text-neutral-500"},"Searching...",-1))])])):unref(error)?(openBlock(),createElementBlock("div",_hoisted_10,[createBaseVNode("p",_hoisted_11,"Failed to search: "+toDisplayString(unref(error).message),1)])):!unref(hasResults)&&searchQuery.value&&!unref(isSearching)?(openBlock(),createElementBlock("div",_hoisted_12,[createVNode(_component_Icon,{name:"heroicons:magnifying-glass",class:"h-12 w-12 text-neutral-300 mx-auto mb-3"}),_cache[5]||(_cache[5]=createBaseVNode("h3",{class:"text-lg font-medium text-neutral-900 mb-1"},"No results found",-1)),_cache[6]||(_cache[6]=createBaseVNode("p",{class:"text-neutral-500"},"Try adjusting your search query or filters",-1))])):unref(hasResults)?(openBlock(),createElementBlock("div",_hoisted_13,[fileResults.value.length>0?(openBlock(),createElementBlock("section",_hoisted_14,[createBaseVNode("h2",_hoisted_15,"Files ("+toDisplayString(fileResults.value.length)+")",1),createBaseVNode("div",_hoisted_16,[(openBlock(!0),createElementBlock(Fragment,null,renderList(fileResults.value,file=>(openBlock(),createBlock(unref(_sfc_main$3),{key:file.id,class:"cursor-pointer hover:border-primary-300 transition-colors",onClick:__name($event=>navigateToFile(file),"onClick")},{default:withCtx(()=>[createBaseVNode("div",_hoisted_17,[createVNode(_component_Icon,{name:"heroicons:document",class:"h-10 w-10 text-neutral-400 flex-shrink-0"}),createBaseVNode("div",_hoisted_18,[createBaseVNode("h3",_hoisted_19,toDisplayString(file.metadata.fileName),1),createBaseVNode("div",_hoisted_20,[file.metadata.category?(openBlock(),createElementBlock("span",_hoisted_21,toDisplayString(file.metadata.category),1)):createCommentVNode("",!0),file.metadata.supplierName?(openBlock(),createElementBlock("span",_hoisted_22,toDisplayString(file.metadata.supplierName),1)):createCommentVNode("",!0),file.metadata.createdAt?(openBlock(),createElementBlock("span",_hoisted_23,toDisplayString(unref(formatDate)(file.metadata.createdAt)),1)):createCommentVNode("",!0)]),file.metadata.extractedText?(openBlock(),createElementBlock("p",_hoisted_24,toDisplayString(file.metadata.extractedText),1)):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_25,toDisplayString(Math.round(file.score*100))+"% ",1)])]),_:2},1032,["onClick"]))),128))])])):createCommentVNode("",!0),supplierResults.value.length>0?(openBlock(),createElementBlock("section",_hoisted_26,[createBaseVNode("h2",_hoisted_27,"Suppliers ("+toDisplayString(supplierResults.value.length)+")",1),createBaseVNode("div",_hoisted_28,[(openBlock(!0),createElementBlock(Fragment,null,renderList(supplierResults.value,supplier=>(openBlock(),createBlock(unref(_sfc_main$3),{key:supplier.id,class:"cursor-pointer hover:border-primary-300 transition-colors",onClick:__name($event=>navigateToSupplier(supplier),"onClick")},{default:withCtx(()=>[createBaseVNode("div",_hoisted_29,[createVNode(_component_Icon,{name:"heroicons:building-office",class:"h-10 w-10 text-neutral-400 flex-shrink-0"}),createBaseVNode("div",_hoisted_30,[createBaseVNode("h3",_hoisted_31,toDisplayString(supplier.metadata.displayName),1),createBaseVNode("p",_hoisted_32,toDisplayString(supplier.metadata.legalName),1),createBaseVNode("div",_hoisted_33,[supplier.metadata.companyNumber?(openBlock(),createElementBlock("span",_hoisted_34,[_cache[7]||(_cache[7]=createBaseVNode("span",{class:"font-medium"},"Company:",-1)),createTextVNode(" "+toDisplayString(supplier.metadata.companyNumber),1)])):createCommentVNode("",!0),supplier.metadata.vatNumber?(openBlock(),createElementBlock("span",_hoisted_35,[_cache[8]||(_cache[8]=createBaseVNode("span",{class:"font-medium"},"VAT:",-1)),createTextVNode(" "+toDisplayString(supplier.metadata.vatNumber),1)])):createCommentVNode("",!0)])]),createBaseVNode("div",_hoisted_36,toDisplayString(Math.round(supplier.score*100))+"% ",1)])]),_:2},1032,["onClick"]))),128))])])):createCommentVNode("",!0)])):createCommentVNode("",!0)])]),_:1})])}}});export{_sfc_main as default};
