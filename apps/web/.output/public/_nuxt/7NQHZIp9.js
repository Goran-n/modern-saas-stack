var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{_ as __nuxt_component_0}from"./BdI7D7Kq.js";import{j as useNuxtApp,a as useSupabaseUser,e as useTenantStore,n as navigateTo,g as useRuntimeConfig}from"./BGn8T2aB.js";import{_ as _sfc_main$1}from"./BeaoTUGu.js";import{f as ref,ae as withAsyncContext,E as computed,A as onMounted,O as createElementBlock,X as createVNode,W as withCtx,G as unref,P as openBlock,a2 as createBaseVNode,a4 as createTextVNode,a3 as toDisplayString,a5 as createCommentVNode}from"./BRSJK7Xo.js";const _hoisted_1={class:"min-h-screen bg-neutral-50"},_hoisted_2={class:"mx-auto w-full max-w-md"},_hoisted_3={class:"mt-8 bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},_hoisted_4={key:0,class:"text-center"},_hoisted_5={key:1,class:"text-center"},_hoisted_6={key:2},_hoisted_7={class:"space-y-6"},_hoisted_8={class:"mt-2 text-sm text-gray-600"},_hoisted_9={class:"font-semibold"},_hoisted_10=["disabled"],_hoisted_11={key:0,class:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24"},_sfc_main={__name:"slack-install",async setup(__props){let __temp,__restore;const{$trpc}=useNuxtApp(),config=useRuntimeConfig(),user=useSupabaseUser(),tenantStore=useTenantStore(),installing=ref(!1);[__temp,__restore]=withAsyncContext(()=>tenantStore.fetchUserTenants()),await __temp,__restore();const tenantId=computed(()=>tenantStore.selectedTenantId),tenantName=computed(()=>tenantStore.selectedTenant?.name||"your organisation");async function installSlack(){if(!user.value){await navigateTo("/login");return}if(!tenantId.value){alert("Please select an organisation first");return}installing.value=!0;const oauthApiUrl=config.public.oauthApiUrl||config.public.apiUrl;if(!oauthApiUrl){alert("OAuth API URL not configured. Please contact support."),installing.value=!1;return}const installUrl=`${oauthApiUrl}/oauth/slack/install?tenantId=${tenantId.value}`;window.location.href=installUrl}return __name(installSlack,"installSlack"),onMounted(()=>{window.addEventListener("message",event=>{event.data.type==="slack-oauth-success"&&(alert("Figgy has been successfully installed to your Slack workspace!"),navigateTo("/dashboard"))})}),(_ctx,_cache)=>{const _component_NuxtLink=__nuxt_component_0;return openBlock(),createElementBlock("div",_hoisted_1,[createVNode(unref(_sfc_main$1),{"max-width":"6xl",class:"py-12"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2,[_cache[10]||(_cache[10]=createBaseVNode("div",{class:"flex justify-center"},[createBaseVNode("h2",{class:"text-3xl font-bold text-gray-900"},"Install Figgy for Slack")],-1)),createBaseVNode("div",_hoisted_3,[unref(user)?unref(tenantId)?(openBlock(),createElementBlock("div",_hoisted_6,[createBaseVNode("div",_hoisted_7,[createBaseVNode("div",null,[_cache[6]||(_cache[6]=createBaseVNode("h3",{class:"text-lg font-medium text-gray-900"},"Ready to install Figgy!",-1)),createBaseVNode("p",_hoisted_8,[_cache[4]||(_cache[4]=createTextVNode(" Click the button below to add Figgy to your Slack workspace for ",-1)),createBaseVNode("span",_hoisted_9,toDisplayString(unref(tenantName)),1),_cache[5]||(_cache[5]=createTextVNode(". ",-1))])]),_cache[8]||(_cache[8]=createBaseVNode("div",{class:"bg-purple-50 p-4 rounded-md"},[createBaseVNode("h4",{class:"text-sm font-medium text-purple-800 mb-2"},"What Figgy will be able to do:"),createBaseVNode("ul",{class:"text-sm text-purple-700 space-y-1"},[createBaseVNode("li",null,"• Read messages sent directly to @Figgy"),createBaseVNode("li",null,"• Respond to your financial queries"),createBaseVNode("li",null,"• Process invoices and receipts you share"),createBaseVNode("li",null,"• Send you notifications about important updates")])],-1)),createBaseVNode("div",null,[createBaseVNode("button",{onClick:installSlack,disabled:unref(installing),class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50"},[unref(installing)?createCommentVNode("",!0):(openBlock(),createElementBlock("svg",_hoisted_11,_cache[7]||(_cache[7]=[createBaseVNode("path",{d:"M14.53 1.53a1.5 1.5 0 0 0-2.12 0L9.88 4.06a1.5 1.5 0 0 0 0 2.12l7.07 7.07a1.5 1.5 0 0 0 2.12 0l2.53-2.53a1.5 1.5 0 0 0 0-2.12L14.53 1.53zM4.06 9.88a1.5 1.5 0 0 0 0 2.12l7.07 7.07a1.5 1.5 0 0 0 2.12 0l2.53-2.53a1.5 1.5 0 0 0 0-2.12L8.71 7.35a1.5 1.5 0 0 0-2.12 0L4.06 9.88z"},null,-1)]))),createTextVNode(" "+toDisplayString(unref(installing)?"Redirecting to Slack...":"Add to Slack"),1)],8,_hoisted_10)]),_cache[9]||(_cache[9]=createBaseVNode("div",{class:"text-center"},[createBaseVNode("p",{class:"text-xs text-gray-500"}," You'll be redirected to Slack to authorize the installation ")],-1))])])):(openBlock(),createElementBlock("div",_hoisted_5,[_cache[3]||(_cache[3]=createBaseVNode("p",{class:"text-gray-600 mb-4"}," No organisation selected. Please select an organisation from your dashboard first. ",-1)),createVNode(_component_NuxtLink,{to:"/dashboard",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700"},{default:withCtx(()=>_cache[2]||(_cache[2]=[createTextVNode(" Go to Dashboard ",-1)])),_:1,__:[2]})])):(openBlock(),createElementBlock("div",_hoisted_4,[_cache[1]||(_cache[1]=createBaseVNode("p",{class:"text-gray-600 mb-4"}," To install Figgy in your Slack workspace, you need to be logged in to Figgy first. ",-1)),createVNode(_component_NuxtLink,{to:"/login",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700"},{default:withCtx(()=>_cache[0]||(_cache[0]=[createTextVNode(" Log in to Figgy ",-1)])),_:1,__:[0]})]))]),_cache[11]||(_cache[11]=createBaseVNode("div",{class:"mt-6 text-center"},[createBaseVNode("h3",{class:"text-sm font-medium text-gray-900 mb-2"},"After installation:"),createBaseVNode("ol",{class:"text-sm text-gray-600 text-left max-w-sm mx-auto space-y-1"},[createBaseVNode("li",null,"1. Team members can DM @Figgy to get started"),createBaseVNode("li",null,"2. Figgy will automatically link their accounts"),createBaseVNode("li",null,"3. Start asking financial questions right away!")])],-1))])]),_:1})])}}};export{_sfc_main as default};
