var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import __nuxt_component_2 from"./BPHwrUJ4.js";import{z as defineComponent,f as ref,E as computed,V as createBlock,W as withCtx,ah as withKeys,a6 as withModifiers,U as normalizeClass,G as unref,P as openBlock,a2 as createBaseVNode,O as createElementBlock,a5 as createCommentVNode,X as createVNode,a3 as toDisplayString}from"./BRSJK7Xo.js";import{e as useTenantStore,g as useRuntimeConfig}from"./BGn8T2aB.js";import{_ as _sfc_main$1}from"./rIxWFMco.js";import{g as getFileDisplayName}from"./DQ8mAaII.js";import{F as FileIcon}from"./ksLeJgyi.js";import FileDate from"./kTO7q3pb.js";import FileSize from"./DGtf3NT_.js";import FileBadge from"./Dz2rOXF_.js";import DragIndicator from"./DYqtA-qf.js";import FileAmount from"./UK4U8T1g.js";import FileStatus from"./IVknCLDK.js";import"./B8R4opHw.js";import"./BD-eHdPR.js";import"./CEfzLdwR.js";import"./B8fQSm5j.js";const _hoisted_1={class:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex gap-2"},_hoisted_2=["aria-label","disabled"],_hoisted_3={key:1,class:"w-10 h-10 bg-white rounded-full flex items-center justify-center border-2 border-primary-500"},_hoisted_4={class:"aspect-square flex flex-col items-center justify-center p-4"},_hoisted_5={class:"w-full max-w-[120px] h-[169px] mb-3 flex items-center justify-center"},_hoisted_6=["src","alt"],_hoisted_7=["title"],_hoisted_8={key:0,class:"text-xs text-neutral-600 text-center mt-1"},_hoisted_9={class:"mt-2 text-center space-y-1"},_hoisted_10={key:1,class:"text-xs text-neutral-600"},_hoisted_11={key:1,class:"mt-2"},_hoisted_12={key:2,class:"mt-1"},_sfc_main=defineComponent({__name:"FileCard",props:{file:{},draggable:{type:Boolean,default:!1},isDragging:{type:Boolean,default:!1},isReprocessing:{type:Boolean,default:!1},showReprocess:{type:Boolean,default:!0},showStatus:{type:Boolean,default:!1},showConfidence:{type:Boolean,default:!1}},emits:["select","reprocess"],setup(__props){const props=__props,thumbnailError=ref(!1),displayNameFinal=computed(()=>getFileDisplayName(props.file)),thumbnailUrl=computed(()=>{if(!props.file.thumbnailPath||thumbnailError.value||props.file.mimeType!=="application/pdf")return null;const config=useRuntimeConfig(),tenantStore=useTenantStore();return`${config.public.apiUrl}/api/files/proxy/${props.file.id}?tenantId=${tenantStore.selectedTenantId}&thumbnail=true`}),handleThumbnailError=__name(()=>{thumbnailError.value=!0},"handleThumbnailError");return(_ctx,_cache)=>{const _component_Icon=__nuxt_component_2;return openBlock(),createBlock(unref(_sfc_main$1),{variant:"outlined",padding:"none",role:"button",tabindex:"0","aria-label":`File: ${displayNameFinal.value}. ${_ctx.file.processingStatus==="failed"?"Processing failed. ":""}${_ctx.file.extraction?.extractedFields?.totalAmount?.value?`Amount: ${_ctx.file.extraction.extractedFields.totalAmount.value}. `:""}Click to view details.`,"aria-pressed":!1,class:normalizeClass(["hover:border-primary-300 transition-colors duration-200 group relative cursor-pointer","focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",{"opacity-50":_ctx.isDragging}]),onClick:_cache[1]||(_cache[1]=$event=>_ctx.$emit("select")),onKeydown:[_cache[2]||(_cache[2]=withKeys(withModifiers($event=>_ctx.$emit("select"),["prevent"]),["enter"])),_cache[3]||(_cache[3]=withKeys(withModifiers($event=>_ctx.$emit("select"),["prevent"]),["space"]))]},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[_ctx.showReprocess?(openBlock(),createElementBlock("button",{key:0,onClick:_cache[0]||(_cache[0]=withModifiers($event=>_ctx.$emit("reprocess"),["stop"])),class:normalizeClass(["w-10 h-10 bg-white rounded-full flex items-center justify-center border-2 border-primary-500 hover:bg-primary-50 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-1",{"animate-spin":_ctx.isReprocessing}]),"aria-label":`Reprocess ${displayNameFinal.value}`,disabled:_ctx.isReprocessing},[createVNode(_component_Icon,{name:"heroicons:arrow-path",class:"text-primary-500"})],10,_hoisted_2)):createCommentVNode("",!0),_ctx.draggable?(openBlock(),createElementBlock("div",_hoisted_3,[createVNode(DragIndicator,{size:"md",color:"primary"})])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[thumbnailUrl.value?(openBlock(),createElementBlock("img",{key:0,src:thumbnailUrl.value,alt:`Preview of ${displayNameFinal.value}`,class:"w-full h-full object-contain rounded",loading:"lazy",onError:handleThumbnailError},null,40,_hoisted_6)):(openBlock(),createBlock(FileIcon,{key:1,"file-name":_ctx.file.fileName,size:"xl"},null,8,["file-name"]))]),createBaseVNode("h3",{class:"text-sm font-medium text-neutral-900 text-center line-clamp-2 hover:text-primary-600 transition-colors",title:displayNameFinal.value},toDisplayString(displayNameFinal.value),9,_hoisted_7),_ctx.file.metadata?.supplierName?(openBlock(),createElementBlock("p",_hoisted_8,toDisplayString(_ctx.file.metadata.supplierName),1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_9,[_ctx.file.extraction?.extractedFields?.totalAmount?.value?(openBlock(),createBlock(FileAmount,{key:0,amount:_ctx.file.extraction.extractedFields.totalAmount.value,currency:_ctx.file.extraction?.extractedFields?.currency?.value,size:"sm",variant:"default"},null,8,["amount","currency"])):createCommentVNode("",!0),_ctx.file.extraction?.extractedFields?.documentNumber?.value?(openBlock(),createElementBlock("p",_hoisted_10," #"+toDisplayString(_ctx.file.extraction.extractedFields.documentNumber.value),1)):createCommentVNode("",!0),createVNode(FileDate,{date:_ctx.file.extraction?.extractedFields?.documentDate?.value||_ctx.file.createdAt,size:"xs"},null,8,["date"]),createVNode(FileSize,{bytes:_ctx.file.size||0,size:"xs"},null,8,["bytes"])]),_ctx.showStatus?(openBlock(),createElementBlock("div",_hoisted_11,[createVNode(FileStatus,{status:_ctx.file.processingStatus||"completed","error-message":void 0,"file-name":displayNameFinal.value,size:"xs","show-error-details":!1},null,8,["status","file-name"])])):createCommentVNode("",!0),_ctx.showConfidence&&_ctx.file.extraction?.overallConfidence?(openBlock(),createElementBlock("div",_hoisted_12,[createVNode(FileBadge,{type:"confidence",value:_ctx.file.extraction.overallConfidence,size:"xs"},null,8,["value"])])):createCommentVNode("",!0)])]),_:1},8,["aria-label","class"])}}}),__nuxt_component_0=Object.assign(_sfc_main,{__name:"MoleculesFileCard"});export{__nuxt_component_0 as default};
