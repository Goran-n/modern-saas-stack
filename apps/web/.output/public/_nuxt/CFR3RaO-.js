var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{u as useFileOperations,a as useFileState}from"./J5AnXiKH.js";import{u as useFileFormatters}from"./BD-eHdPR.js";import{z as defineComponent,E as computed,O as createElementBlock,X as createVNode,W as withCtx,G as unref,L as Fragment,a7 as resolveComponent,P as openBlock,a8 as renderList,V as createBlock}from"./BRSJK7Xo.js";import"./BGn8T2aB.js";import"./DOQLo0N3.js";const _sfc_main=defineComponent({__name:"FileList",props:{files:{}},setup(__props){const fileOperations=useFileOperations(),fileState=useFileState(),{formatCurrency}=useFileFormatters(),reprocessModalOpen=computed({get:__name(()=>fileState.reprocessModal.value.isOpen,"get"),set:__name(value=>{value||fileState.closeReprocessModal()},"set")}),formatAmount=__name(file=>{const amount=file.extraction?.extractedFields?.totalAmount?.value,currency=file.extraction?.extractedFields?.currency?.value;return amount?formatCurrency(amount,currency):null},"formatAmount"),columns=[{key:"name",label:"Name",class:"min-w-0 w-2/5"},{key:"status",label:"Status",class:"w-1/5"},{key:"date",label:"Date",class:"w-1/5"},{key:"actions",label:"",class:"w-1/5 text-right"}],handleReprocess=__name(async()=>{const file=fileState.reprocessModal.value.file;if(!file)return;fileState.setReprocessModalProcessing(!0),await fileOperations.reprocessFile(file.id)&&(fileState.closeReprocessModal(),fileState.selectFile(null)),fileState.setReprocessModalProcessing(!1)},"handleReprocess");return(_ctx,_cache)=>{const _component_FileRow=resolveComponent("FileRow"),_component_FileTable=resolveComponent("FileTable"),_component_ReprocessModal=resolveComponent("ReprocessModal");return openBlock(),createElementBlock(Fragment,null,[createVNode(_component_FileTable,{columns},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(_ctx.files,file=>(openBlock(),createBlock(_component_FileRow,{key:file.id,file,"is-reprocessing":unref(fileOperations).isReprocessing(file.id),"show-reprocess":file.processingStatus!=="processing","display-name":file.metadata?.displayName||file.fileName,"total-amount":formatAmount(file),"document-number":file.extraction?.extractedFields?.documentNumber?.value,"document-date":file.extraction?.extractedFields?.documentDate?.value,onView:__name($event=>unref(fileState).selectFile(file),"onView"),onDownload:__name($event=>unref(fileOperations).downloadFile(file),"onDownload"),onReprocess:__name($event=>unref(fileState).openReprocessModal(file),"onReprocess")},null,8,["file","is-reprocessing","show-reprocess","display-name","total-amount","document-number","document-date","onView","onDownload","onReprocess"]))),128))]),_:1}),createVNode(_component_ReprocessModal,{modelValue:reprocessModalOpen.value,"onUpdate:modelValue":_cache[0]||(_cache[0]=$event=>reprocessModalOpen.value=$event),loading:unref(fileState).reprocessModal.value.isProcessing,onConfirm:handleReprocess},null,8,["modelValue","loading"])],64)}}}),__nuxt_component_3=Object.assign(_sfc_main,{__name:"OrganismsFileList"});export{__nuxt_component_3 as default};
