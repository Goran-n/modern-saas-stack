var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import"./BGn8T2aB.js";import{_ as _sfc_main$1}from"./DUt60K_l.js";import FilePreviewHeader from"./CRqHsWWV.js";import FileViewer from"./DZIja_gQ.js";import FileInfoPanel from"./CLyYPccJ.js";import ReprocessModal from"./V6c1Z3HZ.js";import{u as useFileOperations,a as useFileState}from"./J5AnXiKH.js";import{z as defineComponent,f as ref,E as computed,A as onMounted,B as onUnmounted,y as watch,V as createBlock,ad as Teleport,X as createVNode,W as withCtx,G as unref,P as openBlock,a2 as createBaseVNode}from"./BRSJK7Xo.js";import"./DIbFRL3M.js";import"./LqpTdS2-.js";import"./B8R4opHw.js";import"./DQ8mAaII.js";import"./ksLeJgyi.js";import"./BPHwrUJ4.js";import"./kTO7q3pb.js";import"./BD-eHdPR.js";import"./DGtf3NT_.js";import"./DqfWNI9s.js";import"./rIxWFMco.js";import"./Dz2rOXF_.js";import"./CEfzLdwR.js";import"./B8fQSm5j.js";import"./Dfp1CywP.js";import"./hXgEKzhh.js";import"./YOLQlrHt.js";import"./B0BnaaMQ.js";import"./DOQLo0N3.js";const _hoisted_1={class:"px-6 py-4"},_hoisted_2={class:"flex flex-col lg:grid lg:grid-cols-file-preview h-[75vh] lg:h-file-preview-desktop"},_hoisted_3={class:"bg-neutral-50 p-4 sm:p-6 overflow-hidden flex-1 lg:flex-initial"},_hoisted_4={class:"bg-white border-t lg:border-t-0 lg:border-l border-neutral-200 p-4 sm:p-6 overflow-y-auto h-file-preview-mobile lg:h-auto"},_sfc_main=defineComponent({__name:"FilePreview",props:{file:{}},emits:["close"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,fileOperations=useFileOperations(),fileState=useFileState(),isOpen=ref(!0),reprocessModalOpen=computed({get:__name(()=>fileState.reprocessModal.value.isOpen,"get"),set:__name(value=>{value||fileState.closeReprocessModal()},"set")});onMounted(()=>{document.body.style.overflow="hidden"}),onUnmounted(()=>{document.body.style.overflow=""});const proxyUrl=computed(()=>fileOperations.getProxyUrl(props.file.id)),handleDownload=__name(()=>{fileOperations.downloadFile(props.file)},"handleDownload"),handleReprocess=__name(async()=>{const file=fileState.reprocessModal.value.file;if(!file)return;fileState.setReprocessModalProcessing(!0),await fileOperations.reprocessFile(file.id)&&(fileState.closeReprocessModal(),isOpen.value=!1,emit("close")),fileState.setReprocessModalProcessing(!1)},"handleReprocess");return watch(isOpen,newValue=>{newValue||emit("close")}),(_ctx,_cache)=>(openBlock(),createBlock(Teleport,{to:"body"},[createVNode(unref(_sfc_main$1),{modelValue:isOpen.value,"onUpdate:modelValue":_cache[3]||(_cache[3]=val=>isOpen.value=val),size:"6xl",padding:!1},{header:withCtx(()=>[createBaseVNode("div",_hoisted_1,[createVNode(FilePreviewHeader,{file:_ctx.file,"is-reprocessing":unref(fileState).reprocessModal.value.isProcessing,onDownload:handleDownload,onReprocess:_cache[0]||(_cache[0]=$event=>unref(fileState).openReprocessModal(_ctx.file)),onClose:_cache[1]||(_cache[1]=$event=>_ctx.$emit("close"))},null,8,["file","is-reprocessing"])])]),default:withCtx(()=>[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createVNode(FileViewer,{"file-name":_ctx.file.fileName,"proxy-url":proxyUrl.value,onDownload:handleDownload},null,8,["file-name","proxy-url"])]),createBaseVNode("div",_hoisted_4,[createVNode(FileInfoPanel,{file:_ctx.file,onReprocess:_cache[2]||(_cache[2]=$event=>unref(fileState).openReprocessModal(_ctx.file))},null,8,["file"])])])]),_:1},8,["modelValue"]),createVNode(ReprocessModal,{modelValue:reprocessModalOpen.value,"onUpdate:modelValue":_cache[4]||(_cache[4]=$event=>reprocessModalOpen.value=$event),loading:unref(fileState).reprocessModal.value.isProcessing,onConfirm:handleReprocess},null,8,["modelValue","loading"])]))}}),__nuxt_component_4=Object.assign(_sfc_main,{__name:"OrganismsFilePreview"});export{__nuxt_component_4 as default};
