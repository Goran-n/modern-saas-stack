var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import{u as useQuery}from"./BHHfj2p6.js";import{e as useTenantStore}from"./BGn8T2aB.js";import{_ as _sfc_main$2}from"./hXgEKzhh.js";import{a as _sfc_main$1}from"./DIbFRL3M.js";import{_ as _sfc_main$5}from"./BeaoTUGu.js";import{_ as _sfc_main$3}from"./DqfWNI9s.js";import{_ as _sfc_main$4}from"./DOdfRuNH.js";import SearchHeader from"./D7qckWlY.js";import SuppliersGrid from"./C-Fl2Z9S.js";import{u as useApi}from"./Cw4ufSzG.js";import{f as ref,E as computed,z as defineComponent,O as createElementBlock,X as createVNode,G as unref,d as isRef,W as withCtx,P as openBlock,V as createBlock,a2 as createBaseVNode,a4 as createTextVNode,L as Fragment,a8 as renderList,a3 as toDisplayString}from"./BRSJK7Xo.js";import"./B8R4opHw.js";import"./LqpTdS2-.js";import"./zJvaikBT.js";import"./BdaSrZqJ.js";import"./BPHwrUJ4.js";import"./DGo9Esvu.js";import"./CDtqPBeL.js";import"./EPfClsla.js";import"./C-rpVc8X.js";import"./B8fQSm5j.js";import"./CEfzLdwR.js";import"./Dik3jxux.js";import"./BzzzcPO6.js";import"./BzjSxxHY.js";import"./DOQLo0N3.js";const useSupplierSearch=__name(suppliers=>{const searchQuery=ref(""),filteredSuppliers=computed(()=>{if(!suppliers.value)return[];const query=searchQuery.value.toLowerCase().trim();let result=suppliers.value;return query&&(result=result.filter(supplier=>[supplier.legalName,supplier.displayName,supplier.companyNumber,supplier.email,supplier.id].filter(Boolean).some(field=>field.toLowerCase().includes(query)))),[...result].sort((a,b)=>{const nameA=(a.displayName||a.legalName).toLowerCase(),nameB=(b.displayName||b.legalName).toLowerCase();return nameA.localeCompare(nameB)})}),supplierCount=computed(()=>suppliers.value?.length||0),filteredCount=computed(()=>filteredSuppliers.value.length);return{searchQuery,filteredSuppliers,supplierCount,filteredCount}},"useSupplierSearch"),_hoisted_1={class:"min-h-screen bg-neutral-50"},_hoisted_2={key:0,class:"text-center py-16"},_hoisted_3={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},_sfc_main=defineComponent({__name:"index",setup(__props){const api=useApi(),tenantStore=useTenantStore(),selectedTenantId=computed(()=>tenantStore.selectedTenantId),{data:suppliersData,isLoading,error}=useQuery({queryKey:["suppliers",selectedTenantId],queryFn:__name(async()=>{if(!selectedTenantId.value)throw new Error("No tenant selected");return(await api.get("/trpc/suppliers.list")).result.data.json},"queryFn"),enabled:__name(()=>!!selectedTenantId.value,"enabled")}),suppliers=computed(()=>suppliersData.value||[]),{searchQuery,filteredSuppliers,supplierCount,filteredCount}=useSupplierSearch(suppliers);return(_ctx,_cache)=>(openBlock(),createElementBlock("div",_hoisted_1,[createVNode(SearchHeader,{search:unref(searchQuery),"onUpdate:search":_cache[0]||(_cache[0]=$event=>isRef(searchQuery)?searchQuery.value=$event:null),"results-count":unref(filteredCount),"total-count":unref(supplierCount),"show-results-count":!!unref(suppliers),disabled:!!unref(isLoading),class:"sticky top-0 z-10"},null,8,["search","results-count","total-count","show-results-count","disabled"]),createVNode(unref(_sfc_main$5),{"max-width":"6xl",class:"py-8"},{default:withCtx(()=>[!unref(selectedTenantId)&&unref(tenantStore).isLoading?(openBlock(),createElementBlock("div",_hoisted_2,[createVNode(unref(_sfc_main$1),{size:"lg",class:"mx-auto mb-4"}),_cache[1]||(_cache[1]=createBaseVNode("p",{class:"text-neutral-600"},"Loading tenant information...",-1))])):unref(selectedTenantId)?unref(isLoading)?(openBlock(),createElementBlock("div",_hoisted_3,[(openBlock(),createElementBlock(Fragment,null,renderList(6,i=>createVNode(unref(_sfc_main$3),{key:i,class:"h-48 rounded-lg"})),64))])):unref(error)?(openBlock(),createBlock(unref(_sfc_main$2),{key:3,variant:"solid",color:"error",class:"max-w-2xl mx-auto"},{title:withCtx(()=>_cache[4]||(_cache[4]=[createTextVNode("Error loading suppliers",-1)])),default:withCtx(()=>[createTextVNode(" "+toDisplayString(unref(error)?.message||"An error occurred while loading suppliers"),1)]),_:1})):unref(filteredSuppliers).length>0?(openBlock(),createBlock(SuppliersGrid,{key:4,suppliers:unref(filteredSuppliers)},null,8,["suppliers"])):(openBlock(),createBlock(unref(_sfc_main$4),{key:5,type:unref(searchQuery)?"no-results":"empty",title:unref(searchQuery)?"No suppliers found":"No suppliers yet",description:unref(searchQuery)?"Try adjusting your search terms":"Suppliers will appear here once they are added to your account",class:"mt-16"},null,8,["type","title","description"])):(openBlock(),createBlock(unref(_sfc_main$2),{key:1,variant:"subtle",color:"warning",class:"max-w-2xl mx-auto"},{title:withCtx(()=>_cache[2]||(_cache[2]=[createTextVNode("No tenant selected",-1)])),default:withCtx(()=>[_cache[3]||(_cache[3]=createTextVNode(" Please select a tenant to view suppliers. ",-1))]),_:1,__:[3]}))]),_:1})]))}});export{_sfc_main as default};
