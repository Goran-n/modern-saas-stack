var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});import __nuxt_component_0 from"./Eih1rzpN.js";import ReprocessModal from"./V6c1Z3HZ.js";import{u as useFileOperations,a as useFileState}from"./J5AnXiKH.js";import{z as defineComponent,f as ref,E as computed,O as createElementBlock,a2 as createBaseVNode,X as createVNode,L as Fragment,a8 as renderList,G as unref,P as openBlock,C as nextTick}from"./BRSJK7Xo.js";import"./BPHwrUJ4.js";import"./BGn8T2aB.js";import"./rIxWFMco.js";import"./B8R4opHw.js";import"./DQ8mAaII.js";import"./ksLeJgyi.js";import"./kTO7q3pb.js";import"./BD-eHdPR.js";import"./DGtf3NT_.js";import"./Dz2rOXF_.js";import"./CEfzLdwR.js";import"./B8fQSm5j.js";import"./DYqtA-qf.js";import"./UK4U8T1g.js";import"./IVknCLDK.js";import"./hXgEKzhh.js";import"./DIbFRL3M.js";import"./LqpTdS2-.js";import"./DUt60K_l.js";import"./DOQLo0N3.js";const _hoisted_1=["aria-label"],_hoisted_2=["onDragstart"],_sfc_main=defineComponent({__name:"FileGrid",props:{files:{}},emits:["file-selected"],setup(__props,{emit:__emit}){const props=__props,emit=__emit,fileOperations=useFileOperations(),fileState=useFileState(),focusedIndex=ref(0),reprocessModalOpen=computed({get:__name(()=>fileState.reprocessModal.value.isOpen,"get"),set:__name(value=>{value||fileState.closeReprocessModal()},"set")}),handleDragStart=__name((event,file)=>{fileState.startDrag(file),fileOperations.handleFileDragStart(event,file)},"handleDragStart"),handleFileSelect=__name(file=>{fileState.selectFile(file),emit("file-selected",file)},"handleFileSelect"),handleReprocess=__name(async()=>{const file=fileState.reprocessModal.value.file;if(!file)return;fileState.setReprocessModalProcessing(!0),await fileOperations.reprocessFile(file.id)&&(fileState.closeReprocessModal(),fileState.selectFile(null)),fileState.setReprocessModalProcessing(!1)},"handleReprocess"),handleKeyNavigation=__name(async event=>{const screenWidth=window.innerWidth;let columns=2;screenWidth>=1280?columns=6:screenWidth>=1024?columns=5:screenWidth>=768?columns=4:screenWidth>=640&&(columns=3);const totalItems=props.files.length;if(totalItems===0)return;let newIndex=focusedIndex.value;switch(event.key){case"ArrowRight":event.preventDefault(),newIndex=Math.min(focusedIndex.value+1,totalItems-1);break;case"ArrowLeft":event.preventDefault(),newIndex=Math.max(focusedIndex.value-1,0);break;case"ArrowDown":event.preventDefault(),newIndex=Math.min(focusedIndex.value+columns,totalItems-1);break;case"ArrowUp":event.preventDefault(),newIndex=Math.max(focusedIndex.value-columns,0);break;case"Home":event.preventDefault(),newIndex=0;break;case"End":event.preventDefault(),newIndex=totalItems-1;break;default:return}focusedIndex.value=newIndex,await nextTick(),event.currentTarget.querySelectorAll('[role="button"]')[newIndex]?.focus()},"handleKeyNavigation");return(_ctx,_cache)=>{const _component_molecules_file_card=__nuxt_component_0,_component_molecules_reprocess_modal=ReprocessModal;return openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",{class:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",role:"grid","aria-label":`File grid with ${_ctx.files.length} files`,onKeydown:handleKeyNavigation},[(openBlock(!0),createElementBlock(Fragment,null,renderList(_ctx.files,file=>(openBlock(),createElementBlock("div",{key:file.id,draggable:!0,onDragstart:__name($event=>handleDragStart($event,file),"onDragstart"),onDragend:_cache[0]||(_cache[0]=$event=>unref(fileState).endDrag())},[createVNode(_component_molecules_file_card,{file,draggable:!0,"is-dragging":unref(fileState).dragState.value.isDragging,"is-reprocessing":unref(fileOperations).isReprocessing(file.id),"show-reprocess":file.processingStatus!=="processing","show-status":!!(file.processingStatus&&file.processingStatus!=="completed"),"show-confidence":!!file.extraction?.overallConfidence,onSelect:__name($event=>handleFileSelect(file),"onSelect"),onReprocess:__name($event=>unref(fileState).openReprocessModal(file),"onReprocess")},null,8,["file","is-dragging","is-reprocessing","show-reprocess","show-status","show-confidence","onSelect","onReprocess"])],40,_hoisted_2))),128))],40,_hoisted_1),createVNode(_component_molecules_reprocess_modal,{modelValue:reprocessModalOpen.value,"onUpdate:modelValue":_cache[1]||(_cache[1]=$event=>reprocessModalOpen.value=$event),loading:unref(fileState).reprocessModal.value.isProcessing,onConfirm:handleReprocess},null,8,["modelValue","loading"])],64)}}}),__nuxt_component_2=Object.assign(_sfc_main,{__name:"OrganismsFileGrid"});export{__nuxt_component_2 as default};
